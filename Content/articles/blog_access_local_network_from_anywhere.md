---
title: åœ¨å¤–è®¿é—®å®¶åº­å†…ç½‘èµ„æº
date: 2023-06-18
comments: true
urlname: access-local-network-from-anywhere
tags: â¦¿network
updated:
---

ä¸Šç¯‡æ–‡ç« æåˆ°æˆ‘æˆåŠŸæ‹¥æœ‰äº†å…¬ç½‘ IP, é‚£ä¹ˆè¿™ç¯‡æˆ‘ä»¬æ¥æ¢ç´¢ä¸‹å¦‚ä½•å®‰å…¨åœ°åœ¨å¤–è®¿é—®å®¶åº­èµ„æºå§

<!-- more -->

æœ‰äº†å…¬ç½‘ IP å, æˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾åœ°åœ¨è·¯ç”±å™¨ä¸­å°†ç«¯å£æ˜ å°„åˆ°å†…ç½‘è®¾å¤‡ç«¯å£, ä»¥è¾¾åˆ°å¤–ç½‘è®¿é—®çš„ç›®çš„. ä½†æ˜¯è¿™æ ·ä¼šå­˜åœ¨å®‰å…¨éšæ‚£, ä½ èƒ½è®¿é—®åˆ°çš„ç«¯å£åˆ«äººä¹Ÿå¯ä»¥è®¿é—®åˆ°, å³ä½¿éœ€è¦ç™»å½•ä¹Ÿå­˜åœ¨è¢«æš´åŠ›ç ´è§£çš„å¯èƒ½, æœ¬æ–‡ä»‹ç»ä¸€ç§æˆ‘è®¤ä¸ºæ›´åŠ å®‰å…¨åœ°è®¿é—®å®¶åº­å†…ç½‘æœåŠ¡çš„æ–¹å¼

## æ•´ä½“æ€è·¯

åœ¨å®¶åº­è®¾å¤‡ä¸­æ­å»º ss æœåŠ¡ç«¯, åœ¨ä»£ç†è½¯ä»¶ä¸­æ·»åŠ å®¶åº­ ss èŠ‚ç‚¹ä¿¡æ¯, åŒæ—¶åœ¨ä»£ç†è½¯ä»¶ä¸­è®¾ç½®å®¶åº­å†…ç½‘åŸŸåè§„åˆ™, åŒ¹é…åˆ°å®¶åº­å†…ç½‘åŸŸåè§„åˆ™ååˆ™ä½¿ç”¨å®¶åº­ ss èŠ‚ç‚¹è¿›è¡Œç½‘ç»œè¿æ¥

> åœ¨è¿™ä¸ªæ–¹æ¡ˆä¸­, ä»£ç†è½¯ä»¶æ˜¯æ ¸å¿ƒ, æ˜¯éœ€è¦æŒç»­è¿è¡Œçš„, æˆ‘ä½¿ç”¨çš„æ˜¯ Surge, å½“ç„¶ä½ å¯ä»¥å¯ä»¥ä½¿ç”¨å¦‚ Clash ä¹‹ç±»çš„ä»£ç†è½¯ä»¶

## é…ç½®æ­¥éª¤

### ç¬¬ä¸€æ­¥: æ­å»º ss æœåŠ¡ç«¯

é¦–å…ˆæˆ‘ä»¬æ‰¾ä¸€å°é•¿æ—¶é—´å¼€æœºçš„å®¶åº­è®¾å¤‡, è½¯è·¯ç”±æ˜¯ä¸€ä¸ªç†æƒ³çš„é€‰æ‹©, æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨ç”µè„‘

#### è½¯è·¯ç”±è¿è¡Œ ss æœåŠ¡

ä»¥æœ€æµè¡Œçš„è½¯è·¯ç”±ç³»ç»Ÿ Openwrt ä¸ºä¾‹, æˆ‘ä»¬åªéœ€è¦åœ¨ `Services` -> `ShadowsSocksR Plus+` -> `SSR Server` ä¸­é…ç½®ç›¸å…³ä¿¡æ¯å³å¯å¹¶å¯ç”¨å³å¯

![himg](https://a.hanleylee.com/HKMS/2023-07-04220716.png?x-oss-process=style/WaMa)

#### ç”µè„‘è¿è¡Œ ss æœåŠ¡

ç”µè„‘è¿è¡Œ ss æœåŠ¡ä¹Ÿå¾ˆç®€å•, é¦–å…ˆæˆ‘ä»¬ä¿è¯ç”µè„‘ä¸Šå®‰è£…äº† docker, åœ¨ç”µè„‘ä»»æ„ä½ç½®åˆ›å»º `docker-compose.yaml` æ–‡ä»¶, å…¶å†…å®¹å¦‚ä¸‹:

```yaml
shadowsocks:
  image: shadowsocks/shadowsocks-libev
  ports:
    - "8388:8388/tcp"
    - "8388:8388/udp"
  environment:
    - SERVER_ADDR=0.0.0.0
    - SERVER_ADDR_IPV6=::0
    - METHOD=aes-256-gcm
    - DNS_ADDRS=1.1.1.1,1.0.0.1
    - PASSWORD=xxxxxxxxx
  restart: always
```

ç„¶ååœ¨è¯¥æ–‡ä»¶ç›®å½•ä¸‹æ‰§è¡Œ `docker-compose up -d` å³å¯, è¿™æ ·æˆ‘ä»¬çš„ ss æœåŠ¡å°±åœ¨åå°é»˜é»˜åœ°è¿è¡Œäº†

#### æ”¾è¡Œ ss æœåŠ¡ç«¯å£

æˆ‘ä»¬çš„ ss æœåŠ¡æœ€ç»ˆæ˜¯è¦è¢«å¤–éƒ¨ç½‘ç»œè®¿é—®çš„, æ‰€ä»¥éœ€è¦åœ¨è·¯ç”±ä¸­æ·»åŠ ç«¯å£è½¬å‘. ä»¥ Openwrt ç³»ç»Ÿä¸ºä¾‹, åœ¨ `Network` -> `Firewall` -> `Port Forwards` ä¸­åšå¦‚ä¸‹é…ç½®:

![himg](https://a.hanleylee.com/HKMS/2023-07-04223649.png?x-oss-process=style/WaMa)

è¿™é‡Œ `192.168.6.200` æ˜¯æˆ‘ mac mini çš„å†…ç½‘åœ°å€, æ‰€ä»¥è¿™ä¸ªæ˜ å°„çš„å«ä¹‰æ˜¯è®©å¤–éƒ¨æ‰€æœ‰ç½‘ç»œè®¿é—® 8388 ç«¯å£çš„è¯·æ±‚è½¬å‘åˆ°å†…ç½‘ `192.168.6.200` è®¾å¤‡çš„ `8388` ç«¯å£ä¸Š

### ç¬¬äºŒæ­¥: é…ç½®ä»£ç†è½¯ä»¶

åœ¨æˆ‘ä»¬çš„ä»£ç†è½¯ä»¶ä¸­åˆ›å»ºåä¸º *HomeProxySS* çš„ä»£ç†èŠ‚ç‚¹, èŠ‚ç‚¹ä¿¡æ¯ä¸ºç¬¬ä¸€æ­¥åˆ›å»ºçš„èŠ‚ç‚¹ä¿¡æ¯, ä»¥æˆ‘ç°åœ¨ä½¿ç”¨çš„ Surge ä¸ºä¾‹:

![himg](https://a.hanleylee.com/HKMS/2023-07-04221603.png?x-oss-process=style/WaMa)

ç„¶åæˆ‘ä»¬æƒ³ä¸€ä¸ªå¥½è®°çš„å®¶åº­å†…ç½‘è®¿é—®åŸŸåæ®µ(è¿™ä¸ªåŸŸååªæ˜¯ä¸ºäº†æ–¹ä¾¿è®°å¿†, å¹¶ä¸éœ€è¦ä½ çœŸå®æ‹¥æœ‰), ä»¥æˆ‘ä¸ºä¾‹, æˆ‘ä¼šä½¿ç”¨ `home.hanley.com` ä½œä¸ºå®¶åº­åŸŸåæ®µ, ç„¶åå†æ·»åŠ å››çº§åŸŸå `router`, `nas` ç­‰ä½œä¸ºè®¿é—®çš„å®Œæ•´åŸŸå, æ¯”å¦‚ `router.home.hanley.com` ä½œä¸ºæˆ‘è®¿é—®è·¯ç”±å™¨ç®¡ç†é¡µé¢çš„åŸŸå.

åœ¨ Surge ä¸­é…ç½® `DOMAIN-SUFFIX` è§„åˆ™:

![himg](https://a.hanleylee.com/HKMS/2023-07-04222749.png?x-oss-process=style/WaMa)

è¿™æ ·åªæœ‰å½“æˆ‘ä»¬è®¿é—®ä¸º `home.hanley.com` åç¼€çš„åŸŸåæ—¶æ‰ä¼šä½¿ç”¨åˆ° *HomeProxySS*

### ç¬¬ä¸‰æ­¥: é…ç½®æœ¬åœ° Hostnames

åœ¨è·¯ç”±ä¸­é…ç½®æœ¬åœ°åŸŸåè§£æ, è¿˜æ˜¯ä»¥ Openwrt ä¸ºä¾‹, åœ¨ `Network` -> `Hostnames` ä¸­, æ·»åŠ  `router.home.hanley.com` å¯¹åº”çš„å†…ç½‘åœ°å€

![himg](https://a.hanleylee.com/HKMS/2023-07-04224748.png?x-oss-process=style/WaMa)

åˆ°è¿™é‡Œé…ç½®å°±å®Œæˆäº†! ğŸ¥³

## å®é™…ä½¿ç”¨

ç»è¿‡ä»¥ä¸Šçš„é…ç½®, å½“æˆ‘ä»¬ä½¿ç”¨ iPhone åœ¨å®¶åº­å¤–è®¿é—® `router.home.hanley.com` çš„æ—¶å€™

1. ä»£ç†å·¥å…·ä¼šæŠŠç½‘ç»œè¯·æ±‚ä¼šè½¬å‘åˆ° *HomeProxySS* èŠ‚ç‚¹
2. *HomeProxySS* å†å»è¯·æ±‚ `router.home.hanley.com`
3. ç”±äº *HomeProxySS* æ˜¯æˆ‘ä»¬å®¶åº­å†…ç½‘è¿è¡Œçš„æœåŠ¡, å…¶ç½‘ç»œè¯·æ±‚å¿…ç„¶ä¼šç»è¿‡è·¯ç”±å™¨, è·¯ç”±å™¨æ ¹æ® Hostnames é…ç½®å¯¹ *HomeProxySS* è¿”å›äº† `192.168.8.1` åœ°å€
4. *HomeProxySS* è¿›è€Œè¯·æ±‚ `192.168.8.1` è·å¾—è·¯ç”±å™¨ç®¡ç†é¡µé¢çš„å“åº”
5. *HomeProxySS* å°†è¯¥å“åº”è¿”å›ç»™ iPhone

ç„¶åæˆ‘ä»¬å°±èƒ½åœ¨ iPhone ä¸Šçœ‹åˆ°å®¶åº­è·¯ç”±å™¨çš„ç™»å½•é¡µé¢äº†, æ¿€åŠ¨ä¸æ¿€åŠ¨?

![himg](https://a.hanleylee.com/HKMS/2023-07-04231107.jpg?x-oss-process=style/WaMa)

## æ›´å¤šæ‹“å±•ç©æ³•

- ss åªæ˜¯æˆ‘ä»¬å»ºç«‹ä»£ç†è¿æ¥çš„ä¸€ç§æ–¹å¼è€Œå·², é™¤äº† ss æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–çš„æ–¹å¼, æ¯”å¦‚ wireguard, openvpn, surge å¼€å‘çš„ snell ç­‰ç­‰
- æˆ‘ä»¬å¯ä»¥åœ¨å®¶ä¸­çš„å¤šä¸ªè®¾å¤‡ä¸Šéƒ¨ç½²ä»£ç†æœåŠ¡, è¿™æ ·å¯ä»¥ä¿è¯åœ¨å…¶ä¸­ä¸€ä¸ªè®¾å¤‡ä¸èƒ½è®¿é—®çš„æ—¶å€™æœ‰å¤‡ç”¨çš„ä»£ç†èŠ‚ç‚¹å¯ä»¥ä½¿ç”¨
- ä½ å¯ä»¥åœ¨ Hostnames ä¸­æ·»åŠ æ›´å¤šå±€åŸŸç½‘å†…è®¾å¤‡åŸŸåæ˜ å°„å…³ç³», æ¯”å¦‚ `nas.home.hanley.com`, `lenovo_pc.home.hanley.com` ç­‰
- è¿™ç§æ–¹å¼å¯ä»¥ä¸æ­¢ç”¨äºè®¿é—®ç½‘é¡µæœåŠ¡, åŒæ—¶å¯ä»¥è®¿é—® vnc, smb ç­‰æœåŠ¡, æ¯”å¦‚å¯ä»¥é€šè¿‡åœ¨ Finder ä¸­ `Go` -> `Connect to server...` ä¸­è¾“å…¥ `smb://lenovo_pc.home.hanley.com` æ¥è®¿é—®å†…ç½‘è®¾å¤‡é€šè¿‡ smb å…±äº«çš„ç›¸å…³æ–‡ä»¶

<!-- ## å‘ -->

<!-- - surge åœ¨ wireguard æ¨¡å¼ä¸‹çš„ smb è®¿é—®æ—¶ä¸èƒ½ä½¿ç”¨ local dns map -->
<!-- - surge åœ¨åŸŸåè®¿é—®èµ„æºæ—¶æœ€å¿«é€Ÿåº¦ä¸è¶…è¿‡ 12MB/s, ä½¿ç”¨ ip å¯ä»¥æ— é€Ÿåº¦æŸå¤± -->

## Ref

- [Surge Guide â€” è½»æ¾è®¿é—®å®¶ä¸­çš„ç½‘ç»œæœåŠ¡](https://blankwonder.medium.com/surge-guide-è½»æ¾è®¿é—®å®¶ä¸­çš„ç½‘ç»œæœåŠ¡-6188ef189ca8)
